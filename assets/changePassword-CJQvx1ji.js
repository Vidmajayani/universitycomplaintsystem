import{s}from"./supabaseClient-Du47UBJl.js";/* empty css              */document.addEventListener("DOMContentLoaded",async()=>{const g=document.getElementById("changePasswordForm"),a=document.getElementById("newPassword"),d=document.getElementById("confirmPassword"),c=document.getElementById("toggleNewPassword"),i=document.getElementById("toggleConfirmPassword"),u=document.getElementById("eyeIconNew"),f=document.getElementById("eyeOffIconNew"),h=document.getElementById("eyeIconConfirm"),y=document.getElementById("eyeOffIconConfirm");function l(o,e,t){o.type==="password"?(o.type="text",e.classList.remove("hidden"),t.classList.add("hidden")):(o.type="password",e.classList.add("hidden"),t.classList.remove("hidden"))}c&&c.addEventListener("click",()=>{l(a,u,f)}),i&&i.addEventListener("click",()=>{l(d,h,y)});const p=window.location.hash.substring(1),m=new URLSearchParams(p),r=m.get("error_description"),P=m.get("error_code");r&&(alert(`Error: ${r}`),console.error("Supabase error:",P,r));const w=new URLSearchParams(window.location.search).get("code");if(w){const{data:o,error:e}=await s.auth.exchangeCodeForSession(w);e?(console.error("Exchange code error:",e),alert("Invalid or expired link: "+e.message)):console.log("PKCE Session established")}s.auth.onAuthStateChange((o,e)=>{o==="PASSWORD_RECOVERY"&&console.log("Password recovery mode active. Session:",e)}),g.addEventListener("submit",async o=>{o.preventDefault();const e=a.value.trim(),t=d.value.trim();if(!e||e.length<6){alert("Password must be at least 6 characters.");return}if(e!==t){alert("Passwords do not match. Please try again.");return}const{data:{session:E}}=await s.auth.getSession();if(!E){alert("Session invalid or expired. Please request a new password reset link.");return}const{data:v,error:n}=await s.auth.updateUser({password:e});if(n){alert("Error updating password: "+n.message),console.error(n);return}alert("Password updated successfully!"),window.location.href="/Login.html"})});
