import{s as c}from"./supabaseClient-BjEQbO4w.js";const d=window.location.pathname.split("/").pop(),u=["Login.html","ResetPassword.html","ChangePassword.html"];u.includes(d)||(document.documentElement.style.visibility="hidden");(async()=>{if(u.includes(d))document.documentElement.style.visibility="visible";else try{const{data:{session:e},error:t}=await c.auth.getSession();if(t){console.error("Auth check error:",t),window.location.href="Login.html";return}if(!e){window.location.href="Login.html";return}document.documentElement.style.visibility="visible"}catch(e){console.error("Unexpected auth error:",e),window.location.href="Login.html"}})();const g=[document.getElementById("darkModeToggle"),document.getElementById("mobileDarkModeToggle")],a=document.getElementById("mobileMenuButton"),i=document.getElementById("mobileMenu"),o=document.getElementById("overlay"),r=document.getElementById("profileButton"),n=document.getElementById("profileMenu");function m(){document.documentElement.classList.toggle("dark"),localStorage.setItem("theme",document.documentElement.classList.contains("dark")?"dark":"light")}g.forEach(e=>{e&&e.addEventListener("click",m)});(localStorage.getItem("theme")==="dark"||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&document.documentElement.classList.add("dark");a&&i&&(a.addEventListener("click",()=>{i.classList.toggle("-translate-x-full"),o&&o.classList.toggle("hidden")}),o&&o.addEventListener("click",()=>{i.classList.add("-translate-x-full"),o.classList.add("hidden")}));r&&n&&(r.addEventListener("click",e=>{e.stopPropagation(),n.classList.toggle("hidden")}),document.addEventListener("click",e=>{!n.classList.contains("hidden")&&!r.contains(e.target)&&n.classList.add("hidden")}));async function h(e){e.preventDefault();try{const{error:t}=await c.auth.signOut();if(t){console.error("Error signing out:",t),alert("Error logging out. Please try again.");return}localStorage.clear(),window.location.href="Login.html"}catch(t){console.error("Unexpected logout error:",t),alert("Error logging out. Please try again.")}}document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelectorAll('a[href="Login.html"]');console.log(`[darkMode.js] Found ${e.length} links to Login.html`),e.forEach((t,s)=>{const l=t.textContent.replace(/\s+/g," ").trim().toLowerCase();console.log(`[darkMode.js] Link ${s}: "${l}"`),(l.includes("log out")||l.includes("logout"))&&(t.addEventListener("click",h),console.log(`[darkMode.js] âœ… Attached logout handler to link ${s}`))})});
