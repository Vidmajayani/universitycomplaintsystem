import{s as C}from"./supabaseClient-Du47UBJl.js";/* empty css              */document.addEventListener("DOMContentLoaded",()=>{const r=document.getElementById("complaintList"),l=document.getElementById("statusFilter"),c=document.getElementById("categoryFilter"),f=document.getElementById("dateSort");let i=[];const v={Facility:"#009688",Academic:"#8e44ad",Administrative:"#ff9800","Student Disciplinary":"#e91e63",Technical:"#007bff",Other:"#607d8b"},E={Pending:{color:"var(--color-pending)",icon:"â³"},"In-Progress":{color:"var(--color-progress)",icon:"ðŸ”§"},Resolved:{color:"var(--color-resolved)",icon:"âœ…"},Deleted:{color:"#dc3545",icon:"ðŸ—‘ï¸"}};async function k(){const{data:t,error:e}=await C.auth.getUser();return e||!t.user?(m("Unable to load user."),null):t.user}async function w(){r.replaceChildren();const t=await k();if(!t)return;const{data:e,error:a}=await C.from("complaint").select(`
        complaintid,
        complainttitle,
        complaintdescription,
        complaintstatus,
        submitteddate,
        complainantid,
        admin_feedback,
        category:categoryid (categoryname)
      `).eq("complainantid",t.id).order("submitteddate",{ascending:!1});if(a){m("Failed to load complaints.");return}i=e,h(i)}function h(t){if(r.replaceChildren(),!t||t.length===0){m("No Complaints Found");return}t.forEach(e=>{const a=document.createElement("div");a.className="rounded-lg p-4 shadow transition-transform duration-200 hover:scale-[1.02] bg-white dark:bg-gray-800";const u=E[e.complaintstatus]||{color:"#999",icon:"âšª"};a.style.borderLeft=`6px solid ${u.color}`,a.style.border="1px solid var(--color-border-light)",a.classList.add("dark:border-gray-700");const g=document.createElement("h2");g.className="text-lg font-bold mb-1 text-gray-900 dark:text-white",g.textContent=e.complainttitle;const y=document.createElement("p");y.className="text-gray-700 dark:text-gray-300 mb-2",y.textContent=e.complaintdescription;const o=document.createElement("span");o.className="px-3 py-1 text-white rounded text-sm inline-block mb-2",o.style.background=v[e.category?.categoryname]||"#555",o.textContent=e.category?.categoryname||"Other";const d=document.createElement("div");d.className="flex items-center gap-2 mt-1 mb-2";const x=document.createElement("span");x.textContent=u.icon;const s=document.createElement("span");s.textContent=e.complaintstatus,s.style.color=u.color,s.className="font-semibold",d.appendChild(x),d.appendChild(s);let n=null;e.admin_feedback&&(n=document.createElement("div"),n.className="mt-3 bg-gray-50 dark:bg-gray-700 p-3 rounded border-l-4 border-gray-400 dark:border-gray-500 text-sm",e.complaintstatus==="Deleted"&&(n.classList.replace("border-gray-400","border-red-500"),n.classList.replace("bg-gray-50","bg-red-50"),n.classList.add("dark:bg-red-900","dark:text-white")),n.innerHTML=`
            <p class="font-bold text-gray-800 dark:text-gray-200 mb-1">
                <i class="fas fa-comment-dots mr-1"></i> Admin Message:
            </p>
            <p class="text-gray-700 dark:text-gray-300">${e.admin_feedback}</p>
        `);const b=document.createElement("p");b.className="text-sm text-gray-500 mt-2",b.textContent="Submitted: "+new Date(e.submitteddate).toLocaleDateString(),a.appendChild(g),a.appendChild(y),a.appendChild(o),a.appendChild(d),n&&a.appendChild(n),a.appendChild(b),r.appendChild(a)})}function m(t){r.replaceChildren();const e=document.createElement("p");e.className="text-center text-gray-600 dark:text-gray-300 py-6",e.textContent=t,r.appendChild(e)}function p(){let t=[...i];l.value!=="all"&&(t=t.filter(e=>e.complaintstatus===l.value)),c.value!=="all"&&(t=t.filter(e=>e.category?.categoryname===c.value)),t.sort((e,a)=>f.value==="newest"?new Date(a.submitteddate)-new Date(e.submitteddate):new Date(e.submitteddate)-new Date(a.submitteddate)),h(t)}l.addEventListener("change",p),c.addEventListener("change",p),f.addEventListener("change",p),w()});
