import{s as t}from"./supabaseClient-Du47UBJl.js";/* empty css              */document.addEventListener("DOMContentLoaded",async()=>{const h=document.getElementById("changePasswordForm"),a=document.getElementById("newPassword"),d=document.getElementById("confirmPassword"),i=document.getElementById("toggleNewPassword"),c=document.getElementById("toggleConfirmPassword"),u=document.getElementById("eyeIconNew"),f=document.getElementById("eyeOffIconNew"),y=document.getElementById("eyeIconConfirm"),p=document.getElementById("eyeOffIconConfirm");function l(o,e,s){o.type==="password"?(o.type="text",e.classList.remove("hidden"),s.classList.add("hidden")):(o.type="password",e.classList.add("hidden"),s.classList.remove("hidden"))}i&&i.addEventListener("click",()=>{l(a,u,f)}),c&&c.addEventListener("click",()=>{l(d,y,p)});const P=window.location.hash.substring(1),m=new URLSearchParams(P),n=m.get("error_description"),E=m.get("error_code");n&&(alert(`Error: ${n}`),console.error("Supabase error:",E,n)),new URLSearchParams(window.location.search).get("code");const w=new URLSearchParams(window.location.search),g=w.has("code"),I=window.location.hash.includes("error="),{data:{session:L}}=await t.auth.getSession();if(!L&&!g&&!I){window.location.href="Login.html";return}if(g){const{data:o,error:e}=await t.auth.exchangeCodeForSession(w.get("code"));if(e){console.error("Exchange code error:",e),alert("Invalid or expired link: "+e.message),window.location.href="Login.html";return}else console.log("PKCE Session established")}t.auth.onAuthStateChange((o,e)=>{o==="PASSWORD_RECOVERY"&&console.log("Password recovery mode active. Session:",e)}),h.addEventListener("submit",async o=>{o.preventDefault();const e=a.value.trim(),s=d.value.trim();if(!e||e.length<6){alert("Password must be at least 6 characters.");return}if(e!==s){alert("Passwords do not match. Please try again.");return}const{data:{session:v}}=await t.auth.getSession();if(!v){alert("Session invalid or expired. Please request a new password reset link.");return}const{data:S,error:r}=await t.auth.updateUser({password:e});if(r){alert("Error updating password: "+r.message),console.error(r);return}alert("Password updated successfully!"),window.location.href="Login.html"})});
