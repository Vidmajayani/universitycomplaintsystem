import{s as u}from"./darkMode-0kXEi02e.js";document.addEventListener("DOMContentLoaded",async()=>{const{data:{session:G}}=await u.auth.getSession();if(!G){window.location.href="Login.html";return}const{data:me}=await u.from("admin").select("id, adminrole").eq("id",G.user.id).single();if(!me){window.location.href="Login.html";return}const k=document.getElementById("itemsTableBody"),A=document.getElementById("itemsCardsView"),ge=document.getElementById("itemCardTemplate"),K=document.getElementById("statusFilter"),fe=document.getElementById("itemRowTemplate"),X=document.getElementById("emptyTableStateTemplate"),ee=document.getElementById("emptyCardStateTemplate");document.getElementById("errorTableStateTemplate");let v=[],w=[],c=1;const P=10;let I="all",r={source:"all",categories:[],statuses:[],dateFrom:null,dateTo:null};ke();const R=document.getElementById("tabAllRequests"),U=document.getElementById("tabLostItems"),H=document.getElementById("tabFoundItems"),D=document.getElementById("uploadFoundItemBtn");R.addEventListener("click",()=>T("all")),U.addEventListener("click",()=>T("lost")),H.addEventListener("click",()=>T("found"));function T(e){I=e,c=1,[R,U,H].forEach(n=>n.classList.remove("active")),e==="all"&&R.classList.add("active"),e==="lost"&&U.classList.add("active"),e==="found"&&H.classList.add("active"),r.source=e,document.querySelectorAll(".filter-source-btn").forEach(n=>{n.classList.remove("border-blue-600","bg-blue-50","text-blue-600","dark:bg-blue-900/30","dark:text-blue-300"),n.classList.add("border-gray-300","dark:border-gray-600","text-gray-700","dark:text-gray-300")});const a=document.querySelector(`.filter-source-btn[data-source="${e}"]`);a&&(a.classList.remove("border-gray-300","dark:border-gray-600","text-gray-700","dark:text-gray-300"),a.classList.add("border-blue-600","bg-blue-50","text-blue-600","dark:bg-blue-900/30","dark:text-blue-300")),e==="all"||e==="found"?D.classList.remove("hidden"):D.classList.add("hidden"),L()}(I==="all"||I==="found")&&D.classList.remove("hidden");const O=document.getElementById("uploadFoundModal"),te=document.getElementById("uploadFoundItemForm"),ne=document.getElementById("foundItemImage"),j=document.getElementById("imagePreview"),ye=document.getElementById("previewImg");D.addEventListener("click",()=>{O.classList.remove("hidden")}),document.getElementById("cancelUploadFoundBtn").addEventListener("click",()=>{O.classList.add("hidden"),te.reset(),j.classList.add("hidden")}),ne.addEventListener("change",e=>{const a=e.target.files[0];if(a){const n=new FileReader;n.onload=o=>{ye.src=o.target.result,j.classList.remove("hidden")},n.readAsDataURL(a)}}),document.getElementById("confirmUploadFoundBtn").addEventListener("click",async()=>{await ve()});const q=document.getElementById("filterModal"),M=document.getElementById("filterDrawer"),be=document.getElementById("openFiltersBtn"),pe=document.getElementById("closeFiltersBtn"),Ie=document.getElementById("applyFiltersBtn"),Le=document.getElementById("clearFiltersBtn"),V=document.getElementById("filterBadge"),Y=document.getElementById("searchInput"),oe=document.getElementById("prevPage"),ae=document.getElementById("nextPage"),de=document.getElementById("paginationNumbers");be.addEventListener("click",()=>{q.classList.remove("hidden"),setTimeout(()=>{M.classList.remove("scale-95","opacity-0"),M.classList.add("scale-100","opacity-100")},10)}),pe.addEventListener("click",z),q.addEventListener("click",e=>{e.target===q&&z()});function z(){M.classList.remove("scale-100","opacity-100"),M.classList.add("scale-95","opacity-0"),setTimeout(()=>{q.classList.add("hidden")},300)}document.querySelectorAll(".filter-source-btn").forEach(e=>{e.addEventListener("click",()=>{const a=e.dataset.source;document.querySelectorAll(".filter-source-btn").forEach(n=>{n.classList.remove("border-blue-600","bg-blue-50","text-blue-600","dark:bg-blue-900/30","dark:text-blue-300"),n.classList.add("border-gray-300","dark:border-gray-600","text-gray-700","dark:text-gray-300")}),e.classList.remove("border-gray-300","dark:border-gray-600","text-gray-700","dark:text-gray-300"),e.classList.add("border-blue-600","bg-blue-50","text-blue-600","dark:bg-blue-900/30","dark:text-blue-300"),r.source=a})}),document.querySelector('.filter-source-btn[data-source="all"]').click(),document.querySelectorAll(".filter-category-chip").forEach(e=>{e.addEventListener("click",()=>{const a=e.dataset.category,n=r.categories.indexOf(a);n>-1?(r.categories.splice(n,1),e.classList.remove("border-blue-600","bg-blue-50","text-blue-600","dark:bg-blue-900/30","dark:text-blue-300"),e.classList.add("border-gray-300","dark:border-gray-600","text-gray-700","dark:text-gray-300")):(r.categories.push(a),e.classList.remove("border-gray-300","dark:border-gray-600","text-gray-700","dark:text-gray-300"),e.classList.add("border-blue-600","bg-blue-50","text-blue-600","dark:bg-blue-900/30","dark:text-blue-300"))}),e.classList.add("border-gray-300","dark:border-gray-600","text-gray-700","dark:text-gray-300")}),document.querySelectorAll(".filter-status-chip").forEach(e=>{e.addEventListener("click",()=>{const a=e.dataset.status,n=r.statuses.indexOf(a);n>-1?(r.statuses.splice(n,1),e.classList.remove("border-blue-600","bg-blue-50","text-blue-600","dark:bg-blue-900/30","dark:text-blue-300"),e.classList.add("border-gray-300","dark:border-gray-600","text-gray-700","dark:text-gray-300")):(r.statuses.push(a),e.classList.remove("border-gray-300","dark:border-gray-600","text-gray-700","dark:text-gray-300"),e.classList.add("border-blue-600","bg-blue-50","text-blue-600","dark:bg-blue-900/30","dark:text-blue-300"))}),e.classList.add("border-gray-300","dark:border-gray-600","text-gray-700","dark:text-gray-300")}),document.querySelectorAll(".date-preset-btn").forEach(e=>{e.addEventListener("click",()=>{const a=e.dataset.preset,n=new Date;let o,d;switch(a){case"today":o=d=n;break;case"last7days":d=n,o=new Date(n),o.setDate(n.getDate()-7);break;case"last30days":d=n,o=new Date(n),o.setDate(n.getDate()-30);break;case"thismonth":o=new Date(n.getFullYear(),n.getMonth(),1),d=n;break}const l=i=>{const m=i.getFullYear(),t=String(i.getMonth()+1).padStart(2,"0"),s=String(i.getDate()).padStart(2,"0");return`${m}-${t}-${s}`};document.getElementById("filterModalDateFrom").value=l(o),document.getElementById("filterModalDateTo").value=l(d),document.querySelectorAll(".date-preset-btn").forEach(i=>{i.classList.remove("border-blue-600","bg-blue-50","text-blue-600","dark:bg-blue-900/30","dark:text-blue-300"),i.classList.add("border-gray-300","dark:border-gray-600","text-gray-700","dark:text-gray-300")}),e.classList.remove("border-gray-300","dark:border-gray-600","text-gray-700","dark:text-gray-300"),e.classList.add("border-blue-600","bg-blue-50","text-blue-600","dark:bg-blue-900/30","dark:text-blue-300")})}),Ie.addEventListener("click",()=>{r.dateFrom=document.getElementById("filterModalDateFrom").value,r.dateTo=document.getElementById("filterModalDateTo").value,re(),T(r.source),z()}),Le.addEventListener("click",()=>{r={source:"all",categories:[],statuses:[],dateFrom:null,dateTo:null},document.querySelectorAll(".filter-category-chip, .filter-status-chip, .date-preset-btn").forEach(e=>{e.classList.remove("border-blue-600","bg-blue-50","text-blue-600","dark:bg-blue-900/30","dark:text-blue-300"),e.classList.add("border-gray-300","dark:border-gray-600","text-gray-700","dark:text-gray-300")}),document.querySelector('.filter-source-btn[data-source="all"]').click(),document.getElementById("filterModalDateFrom").value="",document.getElementById("filterModalDateTo").value="",re(),c=1,L()});function re(){let e=0;r.source!=="all"&&e++,e+=r.categories.length,e+=r.statuses.length,(r.dateFrom||r.dateTo)&&e++,e>0?(V.textContent=e,V.classList.remove("hidden")):V.classList.add("hidden")}Y.addEventListener("input",()=>{c=1,L()}),oe.addEventListener("click",()=>{c>1&&(c--,L())}),ae.addEventListener("click",()=>{c++,L()});const W=new URLSearchParams(window.location.search).get("status");W&&Array.from(K.options).some(a=>a.value===W)&&(K.value=W),await J(),await N();async function J(){const{data:e,error:a}=await u.from("lost_and_found").select("*").neq("status","Deleted").order("reported_date",{ascending:!1});if(a){console.error(a),k.innerHTML="";const n=document.getElementById("errorTableStateTemplate");n?k.appendChild(n.content.cloneNode(!0)):k.innerHTML='<tr><td colspan="7" class="text-center py-6 text-red-500">Error loading items</td></tr>';return}v=e,w.length>0&&L()}async function N(){const{data:e,error:a}=await u.from("found_items").select("*").order("created_at",{ascending:!1});if(a){console.error("Error loading found items:",a);return}w=e||[],L()}function Ee(e=null){const a=document.getElementById("totalItemsCount"),n=a.parentElement.childNodes[0];let o=0;const d=r.categories.length>0||r.statuses.length>0||r.dateFrom||r.dateTo||Y.value.trim()!=="";e!==null?(o=e,d?n.textContent="Results Found: ":n.textContent="Total Items: "):(I==="all"?o=v.length+w.length:I==="lost"?o=v.length:I==="found"&&(o=w.length),n.textContent="Total Items: "),a.innerText=o}function L(){k.innerHTML="",A.innerHTML="";const e=Y.value.toLowerCase();let a=[];I==="all"?a=[...v.map(t=>({...t,itemSource:"lost"})),...w.map(t=>({...t,itemSource:"found"}))]:I==="lost"?a=v.map(t=>({...t,itemSource:"lost"})):I==="found"&&(a=w.map(t=>({...t,itemSource:"found"})));let n=a.filter(t=>{const s=r.categories.length===0||r.categories.includes(t.item_type),_=r.statuses.length===0||r.statuses.includes(t.status);let p=!0;if(r.dateFrom||r.dateTo){const h=new Date(t.itemSource==="lost"?t.reported_date:t.created_at);if(h.setHours(0,0,0,0),r.dateFrom){const g=new Date(r.dateFrom);g.setHours(0,0,0,0),h<g&&(p=!1)}if(r.dateTo&&p){const g=new Date(r.dateTo);g.setHours(0,0,0,0),h>g&&(p=!1)}}const S=t.itemSource==="lost"?t.location_lost||"":t.location_found||"",F=(t.item_name||"").toLowerCase().includes(e)||(t.item_type||"").toLowerCase().includes(e)||(t.description||"").toLowerCase().includes(e)||(t.distinguishing_features||"").toLowerCase().includes(e)||(t.brand||"").toLowerCase().includes(e)||(t.model||"").toLowerCase().includes(e)||(t.serial_number||"").toLowerCase().includes(e)||(t.primary_color||"").toLowerCase().includes(e)||(t.secondary_color||"").toLowerCase().includes(e)||S.toLowerCase().includes(e);return s&&_&&p&&F});const o=n.length,d=Math.ceil(o/P);Ee(o),c>d&&(c=d||1),c<1&&(c=1);const l=(c-1)*P,i=Math.min(l+P,o),m=n.slice(l,i);if(document.getElementById("startRange").textContent=o===0?0:l+1,document.getElementById("endRange").textContent=i,document.getElementById("totalEntries").textContent=o,xe(d),n.length===0){he();return}m.forEach(t=>{const s=t.itemSource==="found";t.date_lost&&new Date(t.date_lost).toLocaleDateString();const _=s?t.created_at?new Date(t.created_at).toLocaleDateString():"N/A":t.reported_date?new Date(t.reported_date).toLocaleDateString():"N/A",p=s?t.location_found||"Unknown":t.location_lost||"Unknown",S=t.brand?`Brand: ${t.brand}`:"",F=t.primary_color?`Color: ${t.primary_color}`:"",h=[S,F].filter(Boolean).join(", ")||"-";let g="bg-gray-200 text-gray-800 dark:bg-gray-700 dark:text-gray-300",C=t.status||"N/A";s?(t.status==="Unclaimed"&&(g="bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300"),t.status==="Claimed"&&(g="bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300")):(t.status==="Lost"&&(g="bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-300"),t.status==="Claim"&&(g="bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300"),t.status==="Found"&&(g="bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300"),t.status==="Deleted"&&(g="bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300"));const x=s?t.found_item_id:t.item_id,f=fe.content.cloneNode(!0);f.querySelector(".item-name").textContent=t.item_name;const $=f.querySelector(".item-source");s?($.textContent="Found Item",$.className="item-source px-2 py-1 rounded-full text-xs font-bold whitespace-nowrap bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300"):($.textContent="Lost Item",$.className="item-source px-2 py-1 rounded-full text-xs font-bold whitespace-nowrap bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-300"),f.querySelector(".item-type").textContent=t.item_type,f.querySelector(".item-location").textContent=p,f.querySelector(".item-date").textContent=_,f.querySelector(".item-attributes").textContent=h;const ce=f.querySelector(".item-status");ce.textContent=C,ce.className=`item-status px-3 py-1 rounded-full text-xs font-bold whitespace-nowrap ${g}`,s?(f.querySelector(".btn-edit").style.display="none",f.querySelector(".btn-delete").style.display="none"):(f.querySelector(".btn-edit").onclick=()=>window.openStatusModal(x,t.status,t.itemSource),f.querySelector(".btn-delete").onclick=()=>window.openDeleteModal(x,t.itemSource)),f.querySelector(".btn-preview").href=s?`AdminFoundItemDetails.html?id=${x}`:`AdminLostFoundDetails.html?id=${x}`,k.appendChild(f);const y=ge.content.cloneNode(!0);y.querySelector(".card-type").textContent=t.item_type,y.querySelector(".card-title").textContent=t.item_name,y.querySelector(".card-location span").textContent=p,y.querySelector(".card-date").textContent=_;const ue=y.querySelector(".card-status");ue.textContent=C,ue.className=`card-status px-2 py-0.5 rounded text-[10px] font-bold uppercase ${g}`,y.querySelector(".card-attr").textContent=h,s?(y.querySelector(".btn-edit").style.display="none",y.querySelector(".btn-delete").style.display="none"):(y.querySelector(".btn-edit").onclick=()=>window.openStatusModal(x,t.status,t.itemSource),y.querySelector(".btn-delete").onclick=()=>window.openDeleteModal(x,t.itemSource)),y.querySelector(".Link-preview").href=s?`AdminFoundItemDetails.html?id=${x}`:`AdminLostFoundDetails.html?id=${x}`,A.appendChild(y)})}function he(){if(X){const e=X.content.cloneNode(!0);k.appendChild(e)}if(ee){const e=ee.content.cloneNode(!0);A.appendChild(e)}}function xe(e){de.innerHTML="",oe.disabled=c===1,ae.disabled=c===e||e===0;let a=[];e<=7?a=Array.from({length:e},(n,o)=>o+1):c<=4?a=[1,2,3,4,5,"...",e]:c>=e-3?a=[1,"...",e-4,e-3,e-2,e-1,e]:a=[1,"...",c-1,c,c+1,"...",e],a.forEach(n=>{const o=document.createElement("button");o.className=`px-3 py-1 border rounded ${n===c?"bg-blue-600 text-white border-blue-600":"hover:bg-gray-100 dark:hover:bg-gray-700 dark:border-gray-600 dark:text-white"}`,n==="..."?(o.textContent="...",o.disabled=!0,o.classList.add("cursor-default","border-none")):(o.textContent=n,o.onclick=()=>{c=n,L()}),de.appendChild(o)})}const Q=document.getElementById("statusModal"),Z=document.getElementById("deleteModal"),B=document.getElementById("modalStatusSelect"),se=document.getElementById("modalStatusReason"),le=document.getElementById("modalDeleteReason");let E=null,b=null;window.openStatusModal=(e,a,n)=>{E=e,b=n,B.innerHTML="",n==="found"?B.innerHTML=`
                <option value="Unclaimed">Unclaimed</option>
                <option value="Claimed">Claimed</option>
            `:B.innerHTML=`
                <option value="Lost">Lost</option>
                <option value="Claim">Claim (Match)</option>
                <option value="Found">Found (Returned)</option>
            `,B.value=a,se.value="";const o=document.getElementById("foundItemIdContainer"),d=document.getElementById("modalFoundItemId"),l=document.getElementById("foundItemIdError");B.addEventListener("change",function(){this.value==="Found"&&b!=="found"?o.classList.remove("hidden"):(o.classList.add("hidden"),d.value="",l.classList.add("hidden"))}),a==="Found"&&b!=="found"?o.classList.remove("hidden"):(o.classList.add("hidden"),d.value="",l.classList.add("hidden")),Q.classList.remove("hidden")},window.openDeleteModal=(e,a)=>{E=e,b=a,le.value="",Z.classList.remove("hidden")},document.getElementById("cancelStatusBtn").addEventListener("click",()=>Q.classList.add("hidden")),document.getElementById("cancelDeleteBtn").addEventListener("click",()=>Z.classList.add("hidden")),document.getElementById("confirmStatusBtn").addEventListener("click",async()=>{const e=B.value,a=se.value.trim(),n=document.getElementById("modalFoundItemId").value.trim(),o=document.getElementById("foundItemIdError");if(o.classList.add("hidden"),o.textContent="",!a){alert("Please provide a feedback message/reason.");return}if(e==="Found"&&b!=="found"){if(!n){o.textContent="Found Item ID is required when marking as Found.",o.classList.remove("hidden");return}try{const{data:d,error:l}=await u.from("found_items").select("found_item_id, status").eq("found_item_id",n).single();if(l||!d){o.textContent="Found Item ID does not exist in the system.",o.classList.remove("hidden");return}if(d.status!=="Unclaimed"){o.textContent=`This Found Item is already ${d.status}. Please use an Unclaimed item.`,o.classList.remove("hidden");return}}catch(d){console.error("Validation error:",d),o.textContent="Error validating Found Item ID. Please try again.",o.classList.remove("hidden");return}}if(e==="Claim"&&n){o.textContent="Cannot link Found Item ID when status is Claim. Only use Found Item ID for Found status.",o.classList.remove("hidden");return}try{const d=b==="found"?"found_items":"lost_and_found",l=b==="found"?"found_item_id":"item_id",i={status:e,admin_feedback:a};e==="Found"&&n&&b!=="found"&&(i.matched_found_item_id=n);const{error:m}=await u.from(d).update(i).eq(l,E);if(m)throw m;if(e==="Found"&&n&&b!=="found"){const{error:s}=await u.from("found_items").update({status:"Claimed",matched_lost_item_id:E}).eq("found_item_id",n);s&&(console.error("Error updating found item:",s),alert("Lost item updated, but failed to update found item status. Please check manually."))}const t=v.find(s=>s.item_id===E);t&&t.user_id&&(await u.from("notifications").insert([{userid:t.user_id,type:"LostItemUpdate",message:`Status updated to ${e}. ${a}`,is_read:!1,lost_item_id:E}]),ie(t,e,a)),Q.classList.add("hidden"),await J(),await N(),alert(`Status updated to ${e}`)}catch(d){console.error(d),alert("Failed to update status")}}),document.getElementById("confirmDeleteBtn").addEventListener("click",async()=>{const e=le.value.trim();if(!e){alert("Please provide a reason for deletion.");return}try{const a=b==="found"?"found_items":"lost_and_found",n=b==="found"?"found_item_id":"item_id",{error:o}=await u.from(a).update({status:"Deleted",admin_feedback:e}).eq(n,E);if(o)throw o;const d=v.find(l=>l.item_id===E);d&&d.user_id&&(await u.from("notifications").insert([{userid:d.user_id,type:"Deleted",message:`Your report was deleted. Reason: ${e}`,is_read:!1,lost_item_id:E}]),ie(d,"Deleted",e)),Z.classList.add("hidden"),await J(),await N(),alert("Item marked as deleted.")}catch(a){console.error(a),alert("Failed to delete item")}});async function ie(e,a,n){try{const{data:o,error:d}=await u.from("users").select("email, first_name").eq("id",e.user_id).single();if(d||!o||!o.email)return;const l={to_name:o.first_name||"Student",to_email:o.email,complaint_title:`Lost Item: ${e.item_name}`,new_status:a,message:n};await emailjs.send("service_q77wg09","template_sb3k70p",l,"08jWWt0PNjZJ4BcQw"),console.log("Email sent successfully")}catch(o){console.error("Failed to send email:",o)}}async function ve(){const e=ne.files[0];if(!e){alert("Please upload an image. Image is required for found items.");return}const a=document.getElementById("foundItemName").value.trim(),n=document.getElementById("foundItemType").value,o=document.getElementById("foundLocationFound").value.trim(),d=document.getElementById("foundDateFound").value;if(!a||!n||!o||!d){alert("Please fill in all required fields (Item Name, Type, Location Found, Date Found).");return}if(e.size>5*1024*1024){alert("Image size must be less than 5MB.");return}let l=null;try{const{data:{session:i}}=await u.auth.getSession();if(!i){alert("Session expired. Please login again.");return}const m=e.name.split(".").pop(),s=`found_items/${`${Date.now()}_${Math.random().toString(36).substring(7)}.${m}`}`,{data:_,error:p}=await u.storage.from("lost_found_images").upload(s,e);if(p)throw new Error(`Image upload failed: ${p.message}`);const{data:{publicUrl:S}}=u.storage.from("lost_found_images").getPublicUrl(s),F={admin_id:i.user.id,item_name:a,item_type:n,brand:document.getElementById("foundBrand").value.trim()||null,model:document.getElementById("foundModel").value.trim()||null,primary_color:document.getElementById("foundPrimaryColor").value.trim()||null,secondary_color:document.getElementById("foundSecondaryColor").value.trim()||null,serial_number:document.getElementById("foundSerialNumber").value.trim()||null,distinguishing_features:document.getElementById("foundDistinguishingFeatures").value.trim()||null,description:document.getElementById("foundDescription").value.trim()||null,location_found:o,date_found:d,time_found:document.getElementById("foundTimeFound").value||null,status:"Unclaimed"},{data:h,error:g}=await u.from("found_items").insert([F]).select().single();if(g)throw await u.storage.from("lost_found_images").remove([s]),new Error(`Database insert failed: ${g.message}`);l=h.found_item_id;const{error:C}=await u.from("lost_found_attachments").insert([{found_item_id:h.found_item_id,file_url:S,file_type:"image"}]);if(C)throw await u.from("found_items").delete().eq("found_item_id",l),await u.storage.from("lost_found_images").remove([s]),new Error(`Attachment insert failed: ${C.message}`);alert("Found item uploaded successfully!"),O.classList.add("hidden"),te.reset(),j.classList.add("hidden"),await N(),L()}catch(i){console.error("Error uploading found item:",i),alert(`Failed to upload found item: ${i.message}`)}}function ke(){const e=document.getElementById("mobileMenuButton"),a=document.getElementById("mobileMenu"),n=document.getElementById("overlay");if(e&&a){const m=e.cloneNode(!0);e.parentNode.replaceChild(m,e),m.addEventListener("click",()=>{a.classList.toggle("-translate-x-full"),n&&n.classList.toggle("hidden")}),n&&n.addEventListener("click",()=>{a.classList.add("-translate-x-full"),n.classList.add("hidden")})}const o=document.getElementById("profileButton"),d=document.getElementById("profileMenu");if(o&&d){const m=o.cloneNode(!0);o.parentNode.replaceChild(m,o),m.addEventListener("click",t=>{t.stopPropagation(),d.classList.contains("hidden")?d.classList.remove("hidden"):d.classList.add("hidden")}),document.addEventListener("click",t=>{!m.contains(t.target)&&!d.contains(t.target)&&d.classList.add("hidden")})}const l=document.getElementById("headerLogoutBtn"),i=document.getElementById("logoutModal");if(l&&i){const m=l.cloneNode(!0);l.parentNode.replaceChild(m,l),m.addEventListener("click",()=>i.classList.remove("hidden"));const t=document.getElementById("cancelLogoutBtn"),s=document.getElementById("confirmLogoutBtn");t&&(t.onclick=()=>i.classList.add("hidden")),s&&(s.onclick=async()=>{await u.auth.signOut(),window.location.href="Login.html"})}}});
