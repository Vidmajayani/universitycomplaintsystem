import{s as d}from"./darkMode-JA7tOpVC.js";const A=document.getElementById("adminName"),C=document.getElementById("adminRole"),N=document.getElementById("adminEmail"),w=document.getElementById("adminId"),v=document.getElementById("totalHandled"),I=document.getElementById("logoutBtn"),B=document.getElementById("headerLogoutBtn"),b=document.getElementById("defaultProfileIcon"),u=document.getElementById("profileImage");document.addEventListener("DOMContentLoaded",async()=>{const{data:{session:t}}=await d.auth.getSession();if(!t){window.location.href="Login.html";return}document.getElementById("mainContent").classList.remove("hidden"),x(),q()});async function x(){const{data:{session:t}}=await d.auth.getSession();if(!t){window.location.href="Login.html";return}const{data:e,error:o}=await d.from("admin").select("*").eq("id",t.user.id).single();if(o||!e){console.error("Error fetching admin data:",o),alert("Failed to load profile.");return}if(A.textContent=`${e.adminfirstname} ${e.adminlastname}`,C.textContent=e.adminrole,N.textContent=e.adminemail,w.textContent=e.id,e.profile_pic){u.src=e.profile_pic,u.classList.remove("hidden"),b.classList.add("hidden");const l=document.getElementById("profileButton");l&&(l.innerHTML=`
                <img src="${e.profile_pic}" alt="Profile" class="h-10 w-10 rounded-full object-cover border-2 border-white dark:border-gray-600 shadow-sm">
            `)}else u.classList.add("hidden"),b.classList.remove("hidden");D(e.id,e.adminrole);const n=document.getElementById("profileNavDashboard"),i=document.getElementById("profileNavAllComplaints"),a=document.getElementById("profileNavAnalytics"),r=document.getElementById("mobileProfileNavDashboard"),m=document.getElementById("mobileProfileNavAllComplaints"),g=document.getElementById("mobileProfileNavAnalytics"),h=document.getElementById("footerNavDashboard"),s=document.getElementById("footerNavAllComplaints"),y=document.getElementById("footerNavAnalytics"),f=document.querySelector("footer h2"),E=document.querySelector("footer p");if(e.adminrole==="LostAndFound Admin"){if(n&&(n.href="AdminLostFoundDashboard.html"),r&&(r.href="AdminLostFoundDashboard.html"),i&&(i.innerHTML="Manage Items",i.href="AdminLostFound.html"),m&&(m.textContent="Manage Items",m.href="AdminLostFound.html"),h&&(h.href="AdminLostFoundDashboard.html"),s){const p=s.querySelector("span"),L=s.querySelector("i");p&&(p.textContent="Manage Items"),L&&(L.className="fas fa-search"),s.href="AdminLostFound.html"}a&&(a.style.display="none"),g&&(g.style.display="none"),y&&(y.style.display="none"),f&&(f.textContent="ComplaNet Lost & Found",f.className="text-2xl font-heading font-bold mb-3 text-[var(--color-blue-btn)] dark:text-blue-400"),E&&(E.textContent="Administrative portal for managing university lost and found items. Monitor, verify, and resolve reports efficiently.");const l=document.querySelector(".bg-gray-50.dark\\:bg-gray-700\\/50 p");l&&l.textContent==="Complaints Handled"&&(l.textContent="Items Handled")}}async function D(t,e){try{let o=0;if(e==="LostAndFound Admin"){const{count:n,error:i}=await d.from("lost_and_found").select("item_id",{count:"exact",head:!0}).eq("admin_id",t);if(i)throw i;const{count:a,error:r}=await d.from("found_items").select("found_item_id",{count:"exact",head:!0}).eq("admin_id",t);if(r)throw r;o=(n||0)+(a||0)}else{let n=d.from("complaint").select("complaintid",{count:"exact",head:!0});e!=="Master Admin"&&(n=n.eq("adminid",t));const{count:i,error:a}=await n;if(a)throw a;o=i||0}v.textContent=o}catch(o){console.error("Error loading stats:",o),v.textContent="-"}}function q(){I&&I.addEventListener("click",c),B&&B.addEventListener("click",c);const t=document.getElementById("logoutModal");if(t){const o=document.getElementById("cancelLogoutBtn"),n=document.getElementById("confirmLogoutBtn");o&&o.addEventListener("click",()=>{t.classList.add("hidden")}),n&&n.addEventListener("click",async()=>{const{error:i}=await d.auth.signOut();i&&console.error("Error signing out:",i),window.location.href="Login.html"}),t.addEventListener("click",i=>{i.target===t&&t.classList.add("hidden")})}const e=setInterval(()=>{const o=document.querySelector('#mobileMenu a[href="Login.html"]');if(o)o.addEventListener("click",c),clearInterval(e);else if(document.readyState==="complete"){const n=document.querySelector('#mobileMenu a[href="Login.html"]');n&&n.addEventListener("click",c),clearInterval(e)}},100)}function c(t){t&&t.preventDefault();const e=document.getElementById("logoutModal");e&&e.classList.remove("hidden")}
